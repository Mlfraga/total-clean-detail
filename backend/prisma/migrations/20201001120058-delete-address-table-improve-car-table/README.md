# Migration `20201001120058-delete-address-table-improve-car-table`

This migration has been generated by Matheus Fraga at 10/1/2020, 12:00:58 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Car" ADD COLUMN "carColor" text  NOT NULL ,
ADD COLUMN "carModel" text   ;

ALTER TABLE "public"."Person" DROP COLUMN "telephone";

ALTER TABLE "public"."Sale" ADD COLUMN "availabilityDate" timestamp(3)  NOT NULL ,
ALTER COLUMN "source" SET DEFAULT E'WORKSHOP',
ALTER COLUMN "status" SET DEFAULT E'PENDING';

ALTER TABLE "public"."User" ALTER COLUMN "role" SET DEFAULT E'SELLER';

ALTER TABLE "public"."Address" DROP CONSTRAINT IF EXiSTS "Address_personId_fkey";

DROP TABLE "public"."Address";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200726214212-change-factory-source-to-new..20201001120058-delete-address-table-improve-car-table
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -91,52 +91,42 @@
   service   Service @relation(fields: [serviceId], references: [id])
 }
 model Person {
-  id        Int      @id @default(autoincrement())
-  cpf       String   @unique
-  name      String
-  telephone String
-  address   Address?
-  cars      Car[]
-  sales     Sale[]
+  id    Int    @id @default(autoincrement())
+  cpf   String @unique
+  name  String
+  cars  Car[]
+  sales Sale[]
 }
-model Address {
-  id           Int    @id @default(autoincrement())
-  street       String
-  houseNumber  String
-  neighborhood String
-  city         String
-  uf           String
-  personId     Int
-  person       Person @relation(fields: [personId], references: [id])
-}
-
 model Car {
-  id       Int    @id @default(autoincrement())
+  id       Int     @id @default(autoincrement())
   car      String
   carPlate String
+  carColor String
+  carModel String?
   personId Int
-  person   Person @relation(fields: [personId], references: [id])
+  person   Person  @relation(fields: [personId], references: [id])
   sale     Sale[]
 }
 model Sale {
-  id           Int           @id @default(autoincrement())
-  requestDate  DateTime      @default(now())
-  deliveryDate DateTime
-  status       Status        @default(PENDING)
-  companyPrice Float
-  costPrice    Float
-  source       Source        @default(WORKSHOP)
-  sellerId     Int
-  personId     Int
-  carId        Int
-  seller       Profile       @relation(fields: [sellerId], references: [id])
-  person       Person        @relation(fields: [personId], references: [id])
-  car          Car           @relation(fields: [carId], references: [id])
-  serviceSale  ServiceSale[]
+  id               Int           @id @default(autoincrement())
+  requestDate      DateTime      @default(now())
+  availabilityDate DateTime
+  deliveryDate     DateTime
+  status           Status        @default(PENDING)
+  companyPrice     Float
+  costPrice        Float
+  source           Source        @default(WORKSHOP)
+  sellerId         Int
+  personId         Int
+  carId            Int
+  seller           Profile       @relation(fields: [sellerId], references: [id])
+  person           Person        @relation(fields: [personId], references: [id])
+  car              Car           @relation(fields: [carId], references: [id])
+  serviceSale      ServiceSale[]
 }
 model ServiceSale {
   id        Int     @id @default(autoincrement())
```


